import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import java.text.SimpleDateFormat;
import java.util.Date;

import enums.*;

public class CodeGeneration extends Visitor{

	private PrintWriter writer;
	public CodeGeneration() {
		try {
			writer = new PrintWriter(new FileWriter( MainClass.inputFileName + ".ino", false));
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
	

	private void printHeader() {
		writer.print("/* Phal AutoGenerated .ino file \n" +
				     "*  Created " + new SimpleDateFormat("dd-MM-yyyy").format(new Date()) + 
				     "\n*/\n\n"
				);
	}
	
	@Override
	public void visit(ProgramNode node) {
		printHeader();
		
		// visit includes
		
		visit(node.setupNode);
		visit(node.repeatNode);
		
		writer.close();
	}
	
	@Override
	public void visit(SetupNode node) {
		writer.print("void setup(){ \n");
		// visit setup
		writer.print("} \n\n");
		
		writer.close();
	}
	
	@Override
	public void visit(RepeatNode node) {
		writer.print("void loop(){ \n");
		// visit nodes
		writer.print("} \n\n");
		
		writer.close();
	}
}
 